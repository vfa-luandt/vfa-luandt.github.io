(this.webpackJsonpcsv_merge=this.webpackJsonpcsv_merge||[]).push([[0],{38:function(e,t,a){},41:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(13),s=a.n(r),l=(a(38),a(23)),o=a.n(l),c=a(26),d=a(27),h=a(28),u=a(9),f=a(33),p=a(32),j=(a(40),a(52)),v=a(51),b=a(54),m=a(50),g=a(53),O=(a(41),a(19)),x=a.n(O),w=a(6),y=a.n(w),S=a(14),F=a.n(S),D=a(5),M="\u63a5\u7a2e\u5834\u6240\u3068\u30ef\u30af\u30c1\u30f3\u306e\u7a2e\u985e",C="YYYY-MM-DD",k="\u304a\u96fb\u8a71\u756a\u53f7",L="\u65b0\u578b\u30b3\u30ed\u30ca\u63a5\u7a2e\u5238\u3000\u5238\u756a\u53f7",E="\u63a5\u7a2e\u56de\u6570\uff0e",V="\u63a5\u7a2e\u65e5\uff0e",I="\u30e1\u30fc\u30ab\u30fc\uff0e",R=[],N=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).mergeCsv=Object(c.a)(o.a.mark((function e(){var t,a,i,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.state.data1,a=n.state.data1Error,i=n.state.data2,r=[],i.forEach((function(e,n){if(t.has(n)){var i=t.get(n);y.a.isEmpty(i["\u59d3"])&&(i["\u59d3"]="\u30fb"),y.a.isEmpty(i["\u540d"])&&(i["\u540d"]="\u30fb"),y.a.isEmpty(i[k])&&(i[k]="0"),y.a.isEmpty(i["\u63a5\u7a2e\u5834\u6240"])&&(i["\u63a5\u7a2e\u5834\u6240"]="category#024511_0|20210517|1"),y.a.isEmpty(i[M])&&(i[M]="\uff08\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u7528\uff09\u5b8c\u4e86"),y.a.isEmpty(i["\u4e88\u7d04\u6642\u9593"])&&(i["\u4e88\u7d04\u6642\u9593"]="2021-05-17 08:00"),i["\u63a5\u7a2e\u30ef\u30af\u30c1\u30f3\u306e\u30e1\u30fc\u30ab\u30fc"]=e["\u30e1\u30fc\u30ab\u30fc\uff0e"];var s=F()(new Date(e["\u63a5\u7a2e\u65e5\uff0e"])).format(C);i["\u63a5\u7a2e\u5b9f\u65bd\u65e5"]=s,i["\u72b6\u614b"]="\u5b8c\u4e86",r.push(i)}else if(a.has(n)){var l=a.get(n),o=F()(new Date(e["\u63a5\u7a2e\u65e5\uff0e"])).format(C);l["\u63a5\u7a2e\u5b9f\u65bd\u65e5"]!=o&&R.push(e)}else R.push(e)})),s=x.a.unparse(r,{}),n.input1Ref.current.value="",n.input2Ref.current.value="",n.setState({data1:new Map,data1Error:new Map,data2:new Map,isLoading:!1,showResults:!0,isFinishMerge:!0,resultData:s,errorFound:R.length>0});case 9:case"end":return e.stop()}}),e)}))),n.downloadToFile=function(e,t,a){var n=document.createElement("a"),i=new Blob([e],{type:a});n.href=URL.createObjectURL(i),n.download=t,n.click(),URL.revokeObjectURL(n.href)},n.state={data1:new Map,data1Error:new Map,data2:new Map,fileName:"",errorfileName:"",isLoading:!1,showResults:!1,errorFound:!1,isFinishMerge:!1,resultData:""},n.input1Ref=i.a.createRef(),n.input2Ref=i.a.createRef(),n.handleInputFile=n.handleInputFile.bind(Object(u.a)(n)),n.handleMergeData=n.handleMergeData.bind(Object(u.a)(n)),n.exportErrorFile=n.exportErrorFile.bind(Object(u.a)(n)),n.handleDownLoadFileMerged=n.handleDownLoadFileMerged.bind(Object(u.a)(n)),n.resetState=n.resetState.bind(Object(u.a)(n)),n}return Object(h.a)(a,[{key:"checkFileCSV",value:function(e){var t=e.substr(e.lastIndexOf(".")+1);return-1!==y.a.findIndex(["csv"],(function(e){return e==t}))}},{key:"checkFileType",value:function(e){return e&&e.hasOwnProperty("\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30ad\u30fc")?1:e&&e.hasOwnProperty(I)&&e.hasOwnProperty(V)&&e.hasOwnProperty(E)&&e.hasOwnProperty(L)?2:-1}},{key:"handleInvalidData",value:function(e,t){alert(e),t&&(t.target.value="")}},{key:"handleInputFile",value:function(e){var t=this;R=[],this.setState({isLoading:!0,errorFound:!1,isAvailableDownLoad:!1,resultData:"",isFinishMerge:!1});var a=e.target.value.split("\\").pop();this.checkFileCSV(a)?x.a.parse(e.target.files[0],{delimiter:",",header:!0,skipEmptyLines:!0,trimHeaders:!0,complete:function(n){var i=y.a.first(null===n||void 0===n?void 0:n.data)||void 0;if(n.errors.length>0||!i)return t.handleInvalidData("The CSV file is empty data, Please choose another file.",e),void t.setState({isLoading:!1});1==t.checkFileType(i)?(t.setState({fileName:a.substr(0,a.lastIndexOf("."))}),t.handleDataFile1(n)):2==t.checkFileType(i)?(t.setState({errorfileName:a.substr(0,a.lastIndexOf("."))}),t.handleDataFile2(n)):(t.handleInvalidData("Invalid data format csv must have\u300c\u65b0\u578b\u30b3\u30ed\u30ca\u63a5\u7a2e\u5238\u3000\u5238\u756a\u53f7\u300d\u3001\u300c\u63a5\u7a2e\u56de\u6570\uff0e\u300d\u3001\u300c\u63a5\u7a2e\u65e5\uff0e\u300d\u3001\u300c\u30e1\u30fc\u30ab\u30fc\uff0e\u300dfields. And, must used UTF-8 encoding.",e),t.setState({isLoading:!1}))},transform:function(e,a){return t.validDataString(e)},transformHeader:function(e,a){return e=t.validDataString(e)}}):this.handleInvalidData("Invalid file type",e)}},{key:"validDataString",value:function(e){return e=e.replace(new RegExp(/[="]/g),"")}},{key:"handleDataFile1",value:function(e){for(var t=new Map,a=new Map,n=new Map,i=0;i<e.data.length;i++){var r=e.data[i];if("1\u56de\u76ee"===r["\u63a5\u7a2e\u56de\u6570"]||"2\u56de\u76ee"===r["\u63a5\u7a2e\u56de\u6570"]){var s=r["\u63a5\u7a2e\u5238\u756a\u53f7"]+r["\u63a5\u7a2e\u56de\u6570"];"\u5bfe\u5fdc\u6e08"===r["\u72b6\u614b"]||"\u30ad\u30e3\u30f3\u30bb\u30eb"===r["\u72b6\u614b"]?t.set(s,r):"\u672a\u5bfe\u5fdc"===r["\u72b6\u614b"]?n.set(s,r):"\u5b8c\u4e86"===r["\u72b6\u614b"]&&a.set(s,r)}}n.forEach((function(e,a){t.has(a)||t.set(a,e)})),a.forEach((function(e,a){t.has(a)&&t.delete(a,e)})),this.setState({data1:t,data1Error:a,isLoading:!1})}},{key:"handleDataFile2",value:function(e){for(var t=new Map,a=0;a<e.data.length;a++){var n=e.data[a];"1"!==n["\u63a5\u7a2e\u56de\u6570\uff0e"]&&"2"!==n["\u63a5\u7a2e\u56de\u6570\uff0e"]||y.a.isEmpty(n["\u65b0\u578b\u30b3\u30ed\u30ca\u63a5\u7a2e\u5238\u3000\u5238\u756a\u53f7"])?R.push(n):t.set(n["\u65b0\u578b\u30b3\u30ed\u30ca\u63a5\u7a2e\u5238\u3000\u5238\u756a\u53f7"]+n["\u63a5\u7a2e\u56de\u6570\uff0e"]+"\u56de\u76ee",n)}this.setState({data2:t,isLoading:!1})}},{key:"validateAddEnoughtFileData",value:function(){this.input1Ref.value&&this.input1Ref.value&&(0==this.state.data1.size||0==this.state.data2.size)&&this.handleInvalidData("Can not merge two csv has same type. You must input SwichSmile CSV and another CSV to merge")}},{key:"handleMergeData",value:function(e){var t=this;this.handleProcessData((function(){t.mergeCsv()}))}},{key:"handleProcessData",value:function(e){this.setState({isLoading:!0},(function(){setTimeout((function(){e()}),1e3)}))}},{key:"resetState",value:function(){this.setState({data1:new Map,data1Error:new Map,data2:new Map,fileName:"",errorfileName:"",isLoading:!1,showResults:!1,errorFound:!1,resultData:"",isFinishMerge:!1}),R=[]}},{key:"handleDownLoadFileMerged",value:function(){var e=F()(new Date).format("MMDDYYYYhhmm"),t=this.state.fileName+"_merged_"+e+".csv";this.downloadToFile(this.state.resultData,t,"text/csv;charset=utf-8;")}},{key:"exportErrorFile",value:function(){var e=this;y.a.size(R)>0&&this.setState({isLoading:!0},(function(){setTimeout((function(){var t=x.a.unparse(R),a=F()(new Date).format("MMDDYYYYhhmm");e.downloadToFile(t,[e.state.errorfileName,"error",a+".csv"].join("_"),"text/csv;charset=utf-8;"),e.setState({isLoading:!1})}),100)}))}},{key:"render",value:function(){var e=this;return Object(D.jsxs)("div",{className:"App",children:[Object(D.jsxs)(j.a,{bg:"light",expand:"lg",children:[Object(D.jsx)(j.a.Brand,{href:"#home",children:"CSV\u30de\u30fc\u30b8\u30c4\u30fc\u30eb"}),Object(D.jsx)(j.a.Toggle,{"aria-controls":"basic-navbar-nav"})]}),Object(D.jsxs)("div",{className:"container",children:[Object(D.jsxs)(v.a,{className:"form-container",children:[Object(D.jsxs)("label",{className:"form-input-title",children:["\u4f7f\u7528\u65b9\u6cd5\uff1a",Object(D.jsx)("br",{}),"\u2460 \u5065\u5eb7\u30ab\u30eb\u30c6\u306eCSV\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3092PC\u304b\u3089\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002",Object(D.jsx)("br",{}),"\xa0\xa0\xa0\xa0\u30fb\u3069\u3061\u3089\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3082\u6587\u5b57\u30b3\u30fc\u30c9\u3092UTF-8\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002",Object(D.jsx)("br",{}),"\xa0\xa0\xa0\xa0\u30fb\u5065\u5eb7\u30ab\u30eb\u30c6\u306eCSV\u30d5\u30a1\u30a4\u30eb\u306f\u300c\u65b0\u578b\u30b3\u30ed\u30ca\u63a5\u7a2e\u5238 \u5238\u756a\u53f7\u300d\u3001\u300c\u751f\u5e74\u6708\u65e5\u300d\u3001\u300c\u63a5\u7a2e\u56de\u6570\uff0e\u300d\u3001\u300c\u63a5\u7a2e\u65e5\uff0e\u300d\u3001\u300c\u30e1\u30fc\u30ab\u30fc\uff0e\u300d\u306e\u30c7\u30fc\u30bf\u3092\u5fc5\u9808\u3068\u3057\u307e\u3059\u3002",Object(D.jsx)("br",{}),"\u2461 2\u3064\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u305f\u5f8c\u3001\u300cCSV\u30de\u30fc\u30b8\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",Object(D.jsx)("br",{}),"\u2462 \u300c\u30de\u30fc\u30b8\u3055\u308c\u305f\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0\u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u3001\u30de\u30fc\u30b8\u3055\u308c\u305fCSV\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002",Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),"\u30de\u30fc\u30b8\u306e\u969b\u306b\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u300c\u30de\u30fc\u30b8\u3055\u308c\u306a\u304b\u3063\u305f\u5065\u5eb7\u30ab\u30eb\u30c6\u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u300d\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002",Object(D.jsx)("br",{}),"\u300c\u30de\u30fc\u30b8\u3055\u308c\u306a\u304b\u3063\u305f\u5065\u5eb7\u30ab\u30eb\u30c6\u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3059\u308b\u3068\u3001\u5065\u5eb7\u30ab\u30eb\u30c6\u4e0a\u306e\u30de\u30fc\u30b8\u3055\u308c\u306a\u304b\u3063\u305f\u5185\u5bb9\u304cCSV\u30d5\u30a1\u30a4\u30eb\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002",Object(D.jsx)("br",{})]}),Object(D.jsxs)("div",{className:"form-input-container",children:[Object(D.jsx)(v.a.Group,{controlId:"file1",children:Object(D.jsx)(v.a.File,{id:"fileCSVFile1",label:"\u5065\u5eb7\u30ab\u30eb\u30c6\u306eCSV\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",ref:this.input1Ref,onChange:this.handleInputFile})}),Object(D.jsx)(v.a.Group,{controlId:"file2",children:Object(D.jsx)(v.a.File,{id:"fileCSVFile2",label:"\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0\u306eCSV\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",ref:this.input2Ref,onChange:this.handleInputFile})})]}),this.state.isFinishMerge?Object(D.jsxs)("div",{children:[Object(D.jsx)(b.a,{variant:"primary",type:"button",onClick:this.handleDownLoadFileMerged,disabled:this.state.isLoading,children:"\u30de\u30fc\u30b8\u3055\u308c\u305f\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0\u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"}),this.state.errorFound&&Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(b.a,{variant:"danger",type:"button",className:"ml-4",onClick:this.exportErrorFile,disabled:this.state.isLoading,children:"\u30de\u30fc\u30b8\u3055\u308c\u306a\u304b\u3063\u305f\u5065\u5eb7\u30ab\u30eb\u30c6\u306e\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"})})]}):Object(D.jsx)(b.a,{variant:"primary",type:"button",onClick:this.handleMergeData,disabled:this.state.isLoading,children:"CSV\u30de\u30fc\u30b8"})]}),this.state.isLoading?Object(D.jsx)("div",{className:"loading-container",children:Object(D.jsx)(m.a,{className:"loading-content",animation:"border",variant:"primary",role:"status",children:Object(D.jsx)("span",{className:"sr-only",children:"Loading..."})})}):Object(D.jsx)("div",{}),Object(D.jsx)("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"absolute",minHeight:"200px",top:0,right:0},children:Object(D.jsxs)(g.a,{onClose:function(){return e.setState({showResults:!1})},show:!1,delay:5e3,autohide:!0,children:[Object(D.jsx)(g.a.Header,{children:Object(D.jsx)("strong",{className:"mr-auto",children:"Merge CSV complete."})}),Object(D.jsx)(g.a.Body,{children:"merge CSV file complete. The result CSV will be automatic download."})]})})]})]})}}]),a}(i.a.Component);s.a.render(Object(D.jsx)(i.a.StrictMode,{children:Object(D.jsx)(N,{})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.5520fada.chunk.js.map